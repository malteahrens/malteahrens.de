"use strict";function gestureStart(){for(i=0;i<metas.length;i++)"viewport"==metas[i].name&&(metas[i].content="width=device-width, minimum-scale=0.25, maximum-scale=1.6")}angular.module("angularApp",["ngAnimate","ngCookies","ngResource","ngRoute","ngSanitize","ngTouch","pascalprecht.translate"]).config(["$routeProvider","$translateProvider",function(a,b){a.when("/",{templateUrl:"views/main.html",controller:"MainCtrl"}).when("/about",{templateUrl:"views/about.html",controller:"AboutCtrl"}).otherwise({redirectTo:"/"}),b.translations("de_DE",{APP_HEADLINE:"Bewerbung",SUB_HEADLINE:"Dipl.-Ing. (FH) Kartographie",HEADING1:"Ja ja ja",PARA1:"Über",APP_TEXT:"Irgendein Text über eine großartige AngularJS App."}),b.translations("en_US",{APP_HEADLINE:"Job Application",SUB_HEADLINE:"Master of Cartography",PARA2:"English Translation",HEADING1:"Nothing here"}),b.preferredLanguage("de_DE"),b.fallbackLanguage(["de_DE"]),b.useCookieStorage()}]);var metas=document.getElementsByTagName("meta"),i;if(navigator.userAgent.match(/iPhone/i)){for(i=0;i<metas.length;i++)"viewport"==metas[i].name&&(metas[i].content="width=device-width, minimum-scale=1.0, maximum-scale=1.0");document.addEventListener("gesturestart",gestureStart,!1)}angular.module("angularApp").controller("MainCtrl",["$scope",function(a){a.imgSrc="images/yeoman.png",a.awesomeThings=["HTML5 Boilerplate","AngularJS","Karma"],a.things=[{item:"one"},{item:"two"},{item:"three"}],a.mouseOverThing=function(a){}}]),angular.module("angularApp").controller("LangCtrl",["$scope","$translate",function(a,b){a.changeLang=function(a){b.use(a).then(function(a){console.log("Sprache zu "+a+" gewechselt.")},function(a){console.log("Could not find key."+a)})},a.awesomeThings=["HTML5 Boilerplate","AngularJS","Karma"]}]),angular.module("angularApp").directive("mouseover",function(){return{restrict:"EA",link:function(a,b,c){b.bind("mouseenter",function(b){a.$apply(function(){a.imgSrc=c.mouseover})})}}}),angular.module("angularApp").directive("fadeIn",["$animate",function(a){return{restrict:"A",scope:{ngSrc:"@"},link:function(b,c,d){c.on("load",function(){}).on("error",function(){console.log("error loading image")}),b.$watch("ngSrc",function(d){var e;void 0!=e&&(a.cancel(e),a.removeClass(c,"fadein")),e=a.addClass(c,"fadein"),e.then(function(){a.removeClass(c,"fadein"),b.$apply()})})}}}]),angular.module("angularApp").controller("MapCtrl",["$scope","$http",function(a,b){a.dataPoints=[],a.map={},a.username="Press a button...",a.grid=function(){a.username="should load grid layer"},mapboxgl.accessToken="pk.eyJ1IjoiLS1tYWx0ZWFocmVucyIsImEiOiJGU21QX2VVIn0.GVZ36UsnwYc_JfiQ61lz7Q";var c=new mapboxgl.Map({container:"map",zoom:12.5,center:[48.14882451158226,11.451873779296875],style:"https://www.mapbox.com/mapbox-gl-styles/styles/bright-v7.json",minZoom:9,maxZoom:20,hash:!0,interactive:!0});c.addControl(new mapboxgl.Navigation),c.on("load",function(b){console.log("map loaded..."),a.addGeojsonLayer({name:"Pasing"}),a.addGeojsonLayer({name:"locationAccuracy"}),a.addGeojsonLayer({name:"locationHeading"}),a.addGeojsonLayer({name:"location"})}),a.setPointData=function(a,b){var d=c.getSource(a);if(void 0!==d){var e={type:"Feature",geometry:{type:"Point",coordinates:b}};d.setData(e)}else console.log("Couldn't update data: layer not found")},a.setBufferData=function(a,b,d){var e=c.getSource(a);if(void 0!==e){var f=turf.point(b),g=turf.buffer(f,d,"kilometers");e.setData(g)}else console.log("Couldn't update data: layer not found")},a.setLineData=function(a,b){var d=c.getSource(a);void 0!==d?d.setData(b):console.log("Couldn't update data: layer not found")},a.layerList=[],a.toggleLayer=function(a){console.log("toggle layer: "+a);var b=c.getLayoutProperty(a,"visibility"),d="none";"none"===b&&(d="visible"),c.setLayoutProperty(a,"visibility",d)},a.addGeojsonLayer=function(b,d){void 0===d&&(d=!0);var e={Pasing:{type:"line",layout:{visibility:d},paint:{"line-color":"#ff0000","line-width":2}},PasingWlan_BestLatLon:{type:"symbol",layout:{"icon-image":"circle-12","icon-allow-overlap":!0,"icon-color":"#669966","text-field":"{bssid}","text-font":"Open Sans Semibold, Arial Unicode MS Bold","text-anchor":"bottom-left","icon-ignore-placement":!0,"icon-padding":0,"text-padding":0,"text-optional":!0,"text-allow-overlap":!1,"text-ignore-placement":!1,visibility:d},paint:{"icon-size":.5,"text-size":10,"text-halo-color":"#ffffff","text-translate":[4,2],"text-halo-width":1}},PasingWlan_Sqlite:{type:"symbol",layout:{"icon-image":"{maki}-12","icon-allow-overlap":!0,"icon-color":"#669966","text-field":"{ssid}","text-font":"Open Sans Semibold, Arial Unicode MS Bold","text-anchor":"bottom-left","icon-ignore-placement":!0,"icon-padding":0,"text-padding":0,"text-optional":!0,"text-allow-overlap":!1,"text-ignore-placement":!1,visibility:d},paint:{"icon-size":.5,"text-size":10,"text-halo-color":"#ffffff","text-translate":[4,2],"text-halo-width":1}},PasingWlan_Centroid:{type:"symbol",layout:{"icon-image":"circle-12","icon-allow-overlap":!0,"icon-color":"#669966","text-field":"{ssid}","text-font":"Open Sans Semibold, Arial Unicode MS Bold","text-anchor":"bottom-left","text-optional":!0,"text-allow-overlap":!0,"text-ignore-placement":!0,alwaysVisible:!0,visibility:d},paint:{"icon-size":.5,"icon-color":"#669966","line-color":"#ff0000","line-width":2,"text-size":10,"text-halo-color":"#ffffff","text-translate":[4,2],"text-halo-width":4}},location:{type:"symbol",layout:{"icon-image":"circle-12"},paint:{"icon-size":1,"icon-color":"#669966"}},locationAccuracy:{type:"fill",layout:{visibility:d},paint:{"fill-outline-color":"#ff0000","fill-color":"#ff0000","fill-opacity":.2}},locationHeading:{type:"line",layout:{visibility:d},paint:{"line-color":"#ff0000","line-width":2}}},f="";f="location"!==b.name&&"locationAccuracy"!==b.name?"http://malteahrens.de/data/geojson/"+b.name+".geojson":[0,0],c.addSource(b.name,{type:"geojson",data:f}),c.addLayer({id:b.name,type:e[b.name].type,source:b.name,interactive:!0,layout:e[b.name].layout,paint:e[b.name].paint}),a.layerList.push(b.name),a.$apply()};var d=c.transform.zoom;c.on("zoom",function(){var a=c.getSource("PasingWlan_Sqlite");void 0!==a?(c.transform.zoom>18.5&&18.5>d?(console.log("show labels"),c.setLayoutProperty("PasingWlan_Sqlite","text-allow-overlap",!0)):c.transform.zoom<18.5&&d>18.5&&(console.log("hide labels"),c.setLayoutProperty("PasingWlan_Sqlite","text-allow-overlap",!1)),d=c.transform.zoom):console.log("could not find layer")}),a.trackLocation=!1,a.speed=0,a.heading=0,a.accuracy=0;var e=0;a.toggleTrackLocation=function(){function b(){var a={timeout:6e4};navigator&&navigator.geolocation?navigator.geolocation.getCurrentPosition(f,d,a):console.log("Geolocation is not supported")}function d(a){1==a.code?alert("Error: Access is denied!"):2==a.code&&alert("Error: Position is unavailable!")}function f(b){var d=[b.coords.latitude,b.coords.longitude],e=[b.coords.longitude,b.coords.latitude];if(!isNaN(b.coords.heading)){console.log("heading: "+b.coords.heading);try{var f=b.coords.heading;f>180&&(f=-1*(f-180));var g=turf.destination(point,.1,f,"kilometers"),h=turf.linestring([e,g]);a.setLineData("locationHeading",h),a.heading=f}catch(i){document.getElementById("features").innerHTML=i.message}}if(isNaN(b.coords.speed)||(a.speed=b.coords.speed),!isNaN(b.coords.accuracy)){a.accuracy=b.coords.accuracy;try{var j=.01*b.coords.accuracy;a.setBufferData("locationAccuracy",e,j)}catch(i){document.getElementById("features").innerHTML=i.message}}a.$apply(),c.easeTo(d)}a.trackLocation=!a.trackLocation,a.trackLocation?e=self.setInterval(b,2e3):clearInterval(e)},c.on("mousemove",function(b){c.featuresAt(b.point,{radius:1,layer:"poly"},function(b,c){if(b)throw b;if(c.length>0)for(var d=0;d<c.length;d++)a.highlight(c[d].geometry.coordinates)})}),c.on("click",function(a){console.log("click");var b=a.point;c.featuresAt(b,{radius:10,layer:"PasingWlan_BestLatLon"},function(a,b){if(a)throw a;console.log(b.length),console.log(b),document.getElementById("features").innerHTML=b})}),c.on("moveend",function(a){c.getBounds()}),a.updateLabels=function(){console.log("update"),console.log(c),c.update(),c.render();var a=c.getSource("PasingWlan_BestLatLon");void 0!==a?(console.log("reload"),console.log(a),a.reload()):console.log("could not find layer")}}]);